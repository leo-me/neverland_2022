# 打包优化

1. 速度

    开发
    1. thread loader
    2.


    构建

    1. thread loader
    2.



2. 体积
    - js

     1. 懒加载

        ```js
            lazy(() => import(/* webpackChunkName: "editor" */ 'react-monaco-editor'))

        ```

     2. 拆包

     3. 第三方包达成DLL



    - css

      loader：

      postcss-loader 解析过程




      plugin：

      - cssnano (空格、注释、空的样式、没有用到的样式、)
      - postcss-discard-duplicates （删除重复的样式）
      - css-mqpacker（媒体查询压缩、 合并相同的媒体查询）


      - 图片压缩：关闭base64、上传cdn 或者转换成svg, 关闭图片转base64字符串，减小css打包体积



    - 静态文件： 图片、字体

    图片选型：webp png jpg svg
    图片存储：静态资源，存CDN


webpack5 新特性

1. 编译缓存
   此前通过 babel-loader cache_loader

2. webpack5 增加了确定的 moduleId，chunkId的支持

3. Node Polyfill 脚本被移除，自行添加polyfill

4. 更优的 tree-shaking
    webpack5 对 tree-shaking 进行了优化，分析模块的 export和 import的依赖关系，去掉未被使用的模块


loader 例子

https://github.com/gwuhaolin/comment-require-loader

